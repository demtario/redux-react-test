{"version":3,"sources":["redux/episodes/reducers.js","redux/characters/reducers.js","redux/reducers.js","redux/store.js","components/Header/index.js","components/Collapse/index.js","components/Character/index.js","components/Episode/charactersList.js","utils/index.js","services/api.js","redux/characters/actions.js","redux/characters/fetch.js","components/Episode/index.js","components/AllEpisodes/error.js","redux/episodes/actions.js","redux/episodes/fetch.js","components/AllEpisodes/index.js","App.js","index.js"],"names":["initialState","error","perPage","pages","byId","combineReducers","episodes","state","action","type","allEpisodes","payload","results","forEach","episode","id","info","characters","allCharacters","character","store","createStore","reducers","window","__REDUX_DEVTOOLS_EXTENSION__","Header","title","subtitle","className","defaultProps","Collapse","children","open","onChange","useState","isOpen","setIsOpen","useEffect","onClick","Character","name","image","src","alt","connect","propTypes","list","PropTypes","arrayOf","oneOfType","string","number","CharactersList","React","memo","map","key","getIdFromLink","link","splitted","split","length","API","baseURL","get","endpoint","data","params","fetch","charactersFailure","fetchCharacters","charactersToFetch","a","join","response","status","Error","json","dispatch","message","Episode","onOpenChange","air_date","episodeCharacters","useMemo","url","onOpen","useCallback","fetchedChars","Object","keys","filter","indexOf","fetchData","episodesFailure","fetchEpisodes","page","isAllOpen","setIsAllOpen","setPage","paginatedEpisodes","values","slice","handleShowAllClick","newIsOpen","flat","App","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.f5cd1891.chunk.js","sourcesContent":["const initialState = {\r\n  error: false,\r\n  perPage: 20,\r\n  pages: 0,\r\n  byId: {}\r\n}\r\n\r\nexport const episodes = (state=initialState, action) => {\r\n  switch(action.type) {\r\n    case 'FETCH_EPISODES_SUCCESS':\r\n      const allEpisodes = state.byId\r\n      action.payload.results.forEach((episode) => {\r\n        allEpisodes[episode.id] = episode\r\n      })\r\n      state.pages = action.payload.info.pages\r\n      state.byId = allEpisodes\r\n      state.error = false\r\n      return {...state}\r\n\r\n    case 'FETCH_EPISODES_FAILURE':\r\n      state.error = action.error\r\n      return {...state}\r\n\r\n    default:\r\n      return state\r\n  }\r\n}","const initialState = {\r\n  error: false,\r\n  byId: {}\r\n}\r\n\r\nexport const characters = (state=initialState, action) => {\r\n  switch(action.type) {\r\n    case 'FETCH_CHARACTERS_SUCCESS':\r\n      const allCharacters = state.byId\r\n      action.payload.forEach((character) => {\r\n        allCharacters[character.id] = character\r\n      })\r\n      return {byId: allCharacters, error: false}\r\n\r\n    case 'FETCH_CHARACTERS_FAILURE':\r\n      state.error = action.error\r\n      return {...state}\r\n\r\n    default:\r\n      return state\r\n  }\r\n}","import { combineReducers } from \"redux\";\r\n\r\nimport { episodes } from \"./episodes/reducers\";\r\nimport { characters } from \"./characters/reducers\";\r\n\r\nexport default combineReducers({\r\n  episodes,\r\n  characters\r\n});","import { createStore } from 'redux';\r\nimport reducers from './reducers';\r\n\r\nexport const store = createStore(\r\n  reducers,\r\n  window.__REDUX_DEVTOOLS_EXTENSION__ && window.__REDUX_DEVTOOLS_EXTENSION__()\r\n);","import React from 'react'\r\nimport PropTypes from 'prop-types'\r\n\r\nimport './style.scss'\r\n\r\nconst propTypes = {\r\n  /** Main text of the header */\r\n  title: PropTypes.string,\r\n  /** text under the title */\r\n  subtitle: PropTypes.string\r\n}\r\nconst defaultProps = {\r\n  title: '',\r\n  subtitle: ''\r\n}\r\n\r\nconst Header = ({title, subtitle}) => {\r\n  return (\r\n    <header className=\"header\">\r\n      <div className=\"header__body\">\r\n        <h1 className=\"header__title\">{title}</h1>\r\n        <span className=\"header__credits\">{subtitle}</span>\r\n      </div>\r\n    </header>\r\n  )\r\n}\r\n\r\nHeader.propTypes = propTypes\r\nHeader.defaultProps = defaultProps\r\n\r\nexport default Header","import React, { useCallback, useState, useEffect } from 'react'\r\nimport PropTypes from 'prop-types'\r\n\r\nimport \"./style.scss\"\r\n\r\nconst propTypes = {\r\n  /** boolean to control state of collapse from outside */\r\n  open: PropTypes.bool,\r\n  /** function to raport up when state is changed */\r\n  onChange: PropTypes.func,\r\n  /** text to show in collapse head */\r\n  title: PropTypes.string,\r\n  /** class for collapse body */\r\n  className: PropTypes.string,\r\n}\r\nconst defaultProps = {\r\n  open: false,\r\n  onChange: () => {},\r\n  title: '',\r\n  className: ''\r\n}\r\n\r\nconst Collapse = ({children, open, onChange, title, className}) => {\r\n\r\n  const [isOpen, setIsOpen] = useState(open)\r\n\r\n  useEffect(() => {\r\n    setIsOpen(open)\r\n  }, [open])\r\n\r\n  const toggle = () => {\r\n    setIsOpen(!isOpen)\r\n    onChange(!isOpen)\r\n  }\r\n\r\n  return (\r\n    <div className={`collapse ${isOpen && 'collapse--open'}`}>\r\n      <div className=\"collapse__head\" onClick={toggle}>\r\n        { title }\r\n        <button className=\"collapse__button\">{isOpen ? '-' : '+'}</button>\r\n      </div>\r\n      <div className={`collapse__body ${className}`}>\r\n        { children }\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nCollapse.propTypes = propTypes\r\nCollapse.defaultProps = defaultProps\r\n\r\nexport default Collapse","import React from 'react'\r\nimport PropTypes from 'prop-types'\r\nimport {connect} from 'react-redux'\r\n\r\nimport './style.scss'\r\n\r\nconst propTypes = {\r\n  /** ID of the character to show */\r\n  id: PropTypes.oneOfType([PropTypes.number, PropTypes.string])\r\n}\r\nconst defaultProps = {\r\n  id: 0\r\n}\r\n\r\nconst Character = ({id, characters}) => {\r\n  const {name, image} = characters.byId[id] || {}\r\n\r\n  return (\r\n    <div className={`character ${characters.error && 'character--error'}`}>\r\n      <img src={image} alt={name} className=\"character__image\"/>\r\n      <div className=\"character__name\">{ name || `[ID: ${id}]` }</div>\r\n    </div>\r\n  )\r\n}\r\n\r\nCharacter.propTypes = propTypes\r\nCharacter.defaultProps = defaultProps\r\n\r\nexport default connect(({characters}) => ({characters}))(Character)","import React from 'react'\r\nimport PropTypes from 'prop-types'\r\n\r\nimport Character from '../Character'\r\n\r\nconst propTypes = {\r\n  list: PropTypes.arrayOf(\r\n    PropTypes.oneOfType([PropTypes.string, PropTypes.number])\r\n  )\r\n}\r\nconst defaultProps = {\r\n  list: []\r\n}\r\n\r\nconst CharactersList = React.memo(({list}) => (\r\n  list.map((id) => (\r\n    <Character key={id} id={id} />\r\n  ))\r\n))\r\n\r\nCharactersList.propTypes = propTypes\r\nCharactersList.defaultProps = defaultProps\r\n\r\nexport default CharactersList","export const getIdFromLink = (link) => {\r\n  const splitted = link.split('/')\r\n  return splitted[splitted.length-1]\r\n}","const API = {\r\n  baseURL: 'https://rickandmortyapi.com/api',\r\n\r\n  get: (endpoint, data={}) => {\r\n    let params = '?'\r\n    for(const key in data) {\r\n      params += `${key}=${data[key]}&`\r\n    }\r\n\r\n    return fetch(`${API.baseURL}${endpoint}${params}`)\r\n  }\r\n}\r\n\r\nexport default API","export const charactersFetched = (characters) => ({\r\n  type: 'FETCH_CHARACTERS_SUCCESS',\r\n  payload: characters\r\n});\r\n\r\nexport const charactersFailure = (error) => ({\r\n  type: 'FETCH_CHARACTERS_FAILURE',\r\n  error\r\n});","import {store} from '../store'\r\nimport API from '../../services/api'\r\nimport {charactersFetched, charactersFailure} from './actions'\r\n\r\nexport const fetchCharacters = async (charactersToFetch) => {\r\n  if(charactersToFetch.length === 0) { return } // skip downloading when all fetched\r\n\r\n  try {\r\n    const response = await API.get(`/character/${charactersToFetch.join(',')}`)\r\n\r\n    if(response.status !== 200)\r\n      throw new Error(`Request failed with response status of ${response.status}`)\r\n\r\n    const data = await response.json()\r\n    store.dispatch(charactersFetched(data))\r\n  } catch(e) {\r\n    store.dispatch(charactersFailure(e.message))\r\n  }\r\n\r\n}","import React, { useMemo, useCallback } from 'react'\r\nimport {connect} from 'react-redux'\r\nimport PropTypes from 'prop-types'\r\n\r\nimport Collapse from '../Collapse'\r\nimport CharactersList from './charactersList'\r\n\r\nimport {getIdFromLink} from '../../utils'\r\n\r\nimport {fetchCharacters} from '../../redux/characters/fetch'\r\n\r\nimport './style.scss'\r\n\r\nconst propTypes = {\r\n  /** Object of the current episode */\r\n  episode: PropTypes.shape({\r\n    id: PropTypes.number,\r\n    name: PropTypes.string,\r\n    air_date: PropTypes.string,\r\n    characters: PropTypes.arrayOf(PropTypes.string),\r\n  }),\r\n  /** state to controll collapse from top */\r\n  open: PropTypes.bool,\r\n  /** function to raport of open */\r\n  onOpenChange: PropTypes.func,\r\n}\r\nconst defaultProps = {\r\n  episode: {\r\n    id: null,\r\n    name: '',\r\n    air_date: '',\r\n    characters: []\r\n  },\r\n  open: false,\r\n  onOpenChange: () => {}\r\n}\r\n\r\nconst Episode = ({episode, open, onOpenChange, characters}) => {\r\n\r\n  const { id, name, air_date } = episode\r\n\r\n  const episodeCharacters = useMemo(() => (\r\n    episode.characters.map((url) => getIdFromLink(url))\r\n  ), [episode.characters])\r\n\r\n  const onOpen = useCallback((isOpen) => {\r\n    onOpenChange(isOpen)\r\n\r\n    if(!isOpen) { return }\r\n    const fetchData = () => {\r\n      // Prevent do fetch characters that are already in redux\r\n      const fetchedChars = Object.keys(characters.byId)\r\n      const charactersToFetch = episodeCharacters.filter((id) => fetchedChars.indexOf(id) === -1)\r\n\r\n      fetchCharacters(charactersToFetch)\r\n    }\r\n    fetchData()\r\n  }, [characters, episodeCharacters, onOpenChange])\r\n\r\n  return (\r\n    <Collapse\r\n      title={`Episode ${id}`}\r\n      open={open}\r\n      onChange={onOpen}\r\n      className=\"episode\"\r\n    >\r\n      <ul className=\"episode__properties\">\r\n        <li><strong>ID</strong> <span>{id}</span></li>\r\n        <li><strong>Name</strong> <span>{name}</span></li>\r\n        <li><strong>Air date</strong> <span>{air_date}</span></li>\r\n        <li><strong>Episode</strong> <span>{episode.episode}</span></li>\r\n        <li><strong>Characters</strong></li>\r\n      </ul>\r\n      <div className=\"episode__characters\">\r\n        <CharactersList list={episodeCharacters} />\r\n      </div>\r\n    </Collapse>\r\n  )\r\n}\r\n\r\nEpisode.propTypes = propTypes\r\nEpisode.defaultProps = defaultProps\r\n\r\nexport default connect(({characters}) => ({characters}))(Episode)\r\n","import React from 'react'\r\n\r\nconst Error = ({message}) => (\r\n  <div className=\"error\">\r\n    <div className=\"error__title\">Error!</div>\r\n    <div className=\"error__message\">{message}</div>\r\n  </div>\r\n)\r\n\r\nexport default Error","export const episodesFetched = (episodes) => ({\r\n  type: 'FETCH_EPISODES_SUCCESS',\r\n  payload: episodes\r\n});\r\n\r\nexport const episodesFailure = (error) => ({\r\n  type: 'FETCH_EPISODES_FAILURE',\r\n  error\r\n});","import {store} from '../store'\r\nimport API from '../../services/api'\r\nimport {episodesFetched, episodesFailure} from './actions'\r\n\r\nexport const fetchEpisodes = async (page) => {\r\n  try {\r\n    const response = await API.get('/episode', {page})\r\n\r\n    if(response.status !== 200)\r\n      throw new Error(`Request failed with response status of ${response.status}`)\r\n\r\n    const data = await response.json()\r\n    store.dispatch(episodesFetched(data))\r\n  } catch(e) {\r\n    store.dispatch(episodesFailure(e.message))\r\n  }\r\n}","import React, { useEffect, useState, useMemo, useCallback } from 'react'\r\nimport {connect} from 'react-redux'\r\n\r\nimport Episode from '../Episode/index'\r\nimport Error from './error'\r\n\r\nimport {getIdFromLink} from '../../utils'\r\n\r\nimport {fetchCharacters} from '../../redux/characters/fetch'\r\nimport {fetchEpisodes} from '../../redux/episodes/fetch'\r\n\r\nimport './style.scss'\r\n\r\nconst AllEpisodes = ({episodes, characters}) => {\r\n  const [isAllOpen, setIsAllOpen] = useState(false)\r\n  const [page, setPage] = useState(1)\r\n\r\n\r\n\r\n  const paginatedEpisodes = useMemo(() => {\r\n    return Object\r\n      .values(episodes.byId)\r\n      .slice((page-1)*episodes.perPage, page*episodes.perPage)\r\n  }, [episodes, page])\r\n\r\n\r\n\r\n  useEffect(() => {\r\n    // Don't fetchs episodes that are already downloaded\r\n    if(Object.keys(episodes.byId).length > (page-1) * episodes.perPage) { return }\r\n    fetchEpisodes(page)\r\n  }, [page])\r\n\r\n\r\n\r\n  const handleShowAllClick = useCallback(() => {\r\n    const newIsOpen = !isAllOpen\r\n    setIsAllOpen(newIsOpen)\r\n\r\n    // Fetch missing characters when open all\r\n    if(newIsOpen) {\r\n      const fetchedChars = Object.keys(characters.byId)\r\n\r\n      const charactersToFetch = paginatedEpisodes\r\n        .map((episode) => episode.characters) // Get only charachters url\r\n        .flat() // flat array\r\n        .map((url) => getIdFromLink(url)) // replace urls by id\r\n        .filter((id) => fetchedChars.indexOf(id) === -1) // get only that id's that are not fetched yet\r\n\r\n      fetchCharacters(charactersToFetch)\r\n    }\r\n  }, [isAllOpen, characters, paginatedEpisodes])\r\n\r\n\r\n\r\n  return (\r\n    <div className=\"episodes-list\">\r\n      <h2 className=\"episodes-list__title\">\r\n        All Episodes:\r\n        <span\r\n          className=\"link\"\r\n          onClick={handleShowAllClick}\r\n        >\r\n          {isAllOpen ? 'collapse all' : 'show all'}\r\n        </span>\r\n      </h2>\r\n\r\n      <div className=\"episodes-list__episodes\">\r\n\r\n        { episodes.error &&\r\n          <Error message={episodes.error} />\r\n        }\r\n\r\n        {\r\n          paginatedEpisodes.map((episode) => (\r\n            <Episode\r\n              key={episode.id}\r\n              episode={episode}\r\n              open={isAllOpen}\r\n              onOpenChange={() => {}}\r\n            />\r\n          ))\r\n        }\r\n      </div>\r\n\r\n      <div className=\"episodes-list__pagination\">\r\n        <span\r\n          className={`link ${page === 1 && 'link--disabled'}`}\r\n          onClick={() => {setPage(page-1); setIsAllOpen(false)}}\r\n        >\r\n          prev page\r\n        </span>\r\n        {' |'}\r\n        <span\r\n          className={`link ${page === episodes.pages && 'link--disabled'}`}\r\n          onClick={() => {setPage(page+1); setIsAllOpen(false)}}\r\n        >\r\n          next page\r\n        </span>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default connect(({episodes, characters}) => ({episodes, characters}))(AllEpisodes)\r\n","import React from \"react\";\r\n\r\nimport Header from './components/Header'\r\nimport AllEpisodes from './components/AllEpisodes'\r\n\r\nimport \"./App.scss\";\r\n\r\n/**\r\n * The App\r\n */\r\nconst App = () => {\r\n  return (\r\n    <div>\r\n      <Header\r\n        title=\"Rick and Morty app\"\r\n        subtitle=\"Created by Artur Mędrygał\"\r\n      />\r\n      <div className=\"container\">\r\n        <AllEpisodes />\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default App;\r\n","// IE11 Polyfills\r\nimport 'react-app-polyfill/ie11'\r\n\r\nimport React from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\nimport { Provider } from \"react-redux\";\r\n\r\nimport {store} from './redux/store'\r\nimport App from \"./App\";\r\n\r\nReactDOM.render(\r\n  <Provider store={store}>\r\n    <App />\r\n  </Provider>,\r\n  document.getElementById(\"root\")\r\n);\r\n"],"sourceRoot":""}